<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <script>if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode)) window.location.href="https://support.dmeng.net/upgrade-your-browser.html?referrer="+encodeURIComponent(window.location.href); </script>
    
    
        <link rel="preload" crossorigin="crossorigin" href="/fonts/roboto/Roboto-Regular.woff2" as="font">
        <link rel="preload" crossorigin="crossorigin" href="/fonts/roboto/Roboto-Bold.woff2" as="font">
    
    
    
        <link rel="shortcut icon" href="/ios.github.io/./././images/userImage.JPG">
    

    
    
        
<link rel="stylesheet" href="/ios.github.io/css/mdui.min.v1.0.0.css">

    
    
<link rel="stylesheet" href="/ios.github.io/css/main.css">
<link rel="stylesheet" href="/ios.github.io/css/iconfont.css">


    
    

    
        <script data-ad-client="ca-" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    












          


    
    
    <title>
        
            swift学习日记(六) | 猪会飞的博客
        
    </title>
    
    
<meta name="generator" content="Hexo 8.1.1"></head>
<body class="mdui-drawer-body-left mdui-appbar-with-toolbar mdui-theme-primary-teal mdui-theme-accent-blue">
  
  <header class="mdui-appbar mdui-appbar-fixed">
  <div id="toolbar" class="mdui-toolbar mdui-color-theme">
    <button class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="iconfont icon-menu"></i></button>
    <a href="/ios.github.io/" class="mdui-typo-headline">猪会飞的博客</a>
    <a href="/ios.github.io/" class="header-subtitle mdui-typo-headline"></a>
    <div class="mdui-toolbar-spacer"></div>
    <button class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: 'search'}"><i class="iconfont icon-search"></i></button>
  </div>
</header>

<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="请输入关键字" onfocus="listenSearchFunc()">
    </div>
    <div class="search-result" data-resource="/ios.github.io/search.xml"></div>
  
</div>

  <aside id="sidebar" class="mdui-drawer">
    <div class="mdui-tab" mdui-tab>
        <a href="#sidebar-tab1" id="sidebartab" class="mdui-ripple mdui-tab-active">站点概览</a>
        <a href="#sidebar-tab2" id="sidebartab" class="mdui-ripple">关于</a>
    </div>

    
    <div id="sidebar-tab1" class="mdui-p-a-1">
        <div class="mdui-list">
            
                
                <a href="/ios.github.io/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-home"></i>
                    </div>
                    <div class="mdui-list-item-content">主页</div>
                </a>
            
                
                <a href="/ios.github.io/archives/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-archive"></i>
                    </div>
                    <div class="mdui-list-item-content">归档</div>
                </a>
            
                
                <a href="/ios.github.io/tags/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-bookmark"></i>
                    </div>
                    <div class="mdui-list-item-content">标签</div>
                </a>
            
                
                <a href="/ios.github.io/about/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-user"></i>
                    </div>
                    <div class="mdui-list-item-content">关于</div>
                </a>
            
            <div class="mdui-list-item mdui-ripple">
                <div class="mdui-list-item-icon">
                    <i class="iconfont icon-moon"></i>
                </div>
                <div class="mdui-list-item-content">夜间模式</div>
                <label class="mdui-switch" id="darkmode">
                  <input type="checkbox" id="nightmode_switch"/>
                  <i class="mdui-switch-icon"></i>
                </label>
            </div>           
        </div>
    </div>

    
    <div id="sidebar-tab2" class="mdui-p-a-1">
        <div class="sidebar-overview">
            <div class="sidebar-avatar">
                
                    <img src="/ios.github.io/./././images/userImage.JPG"/>
                
            </div>
            <div class="sidebar-author-name">猪会飞</div>
            <div class="sidebar-description"></div>
        </div>
        <div class="sidebar-links">
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-mail"></i></span>
                    <a href="mailto:2839029331@qq.com" class="mdui-chip-title">E-Mail</a>
                </div>
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-github"></i></span>
                    <a target="_blank" rel="noopener" href="https://github.com/YCCIT123" class="mdui-chip-title">GitHub</a>
                </div>
            
        </div>
        <ul class="mdui-list" mdui-collapse="{accordion: true}">
            <li class="mdui-collapse-item">
                <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-link"></i>
                    </div>
                    <div class="mdui-list-item-content">友情链接</div>
                    <div class="mdui-collapse-item-arrow">
                        <i class="mdui-list-item-icon iconfont icon-angle-down"></i>
                    </div>
                </div>
                <ul id="linksList" class="mdui-collapse-item-body mdui-list mdui-list-dense">
                    
                        <a target="_blank" rel="noopener" href="https://garybear.cn/hexo-theme-meadow/" class="mdui-list-item mdui-ripple">
                            Meadow说明文档
                        </a>
                    
                </ul>
            </li>
        </ul>
    </div>

    <div class="mdui-divider"></div>
    
    
</aside>
  
  <main id="main-contain" class="mdui-container mdui-m-t-5">
    <article id="article" class="mdui-card mdui-p-b-2 mdui-m-b-5">
  <header class="mdui-card-media">
    
    
      <div class="post-header"> 
  <a class="post-header-title" href="/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/">swift学习日记(六)</a>
  <div class="post-header-meta">
    <span>
      <span class="iconfont icon-calendar"></span>
      发布于:&nbsp;2025-12-08
    </span>
    <span>
      <span class="iconfont icon-calendar-check"></span>
      更新于:&nbsp;2025-12-04
    </span>
    <span>
      <span class="iconfont icon-folder"></span>
      分类于:&nbsp;
    </span>
    
  </div>
</div>   
    



    
    
    <div class="mdui-card-menu">
    
      <button class="mdui-btn mdui-btn-icon mdui-text-color-teal" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="iconfont icon-share"></i></button>
      <ul class="mdui-menu" id="share_menu">
        <li class="mdui-menu-item">
          <a href="http://service.weibo.com/share/share.php?appkey=&title=swift学习日记(六)&url=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/&pic=https://yccit123.github.io/ios.github.io/ios.github.io/./././images/userImage.JPG&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到 Weibo</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://twitter.com/intent/tweet?text=swift学习日记(六)&url=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/&via=猪会飞" target="_blank" class="mdui-ripple">分享到 Twitter</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/" target="_blank" class="mdui-ripple">分享到 Facebook</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://plus.google.com/share?url=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/" target="_blank" class="mdui-ripple">分享到 Google+</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/&title=swift学习日记(六)" target="_blank" class="mdui-ripple">分享到 LinkedIn</a>
        </li>
        <li class="mdui-menu-item">
          <a href="http://connect.qq.com/widget/shareqq/index.html?site=猪会飞的博客&title=swift学习日记(六)&summary=&pics=https://yccit123.github.io/ios.github.io/ios.github.io/./././images/userImage.JPG&url=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/" target="_blank" class="mdui-ripple">分享到 QQ</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://telegram.me/share/url?url=https://yccit123.github.io/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/&text=swift学习日记(六)" target="_blank" class="mdui-ripple">分享到 Telegram</a>
        </li>
      </ul>
    
  </div>
  </header>
  
  
  
  
  <div class="post-tags">
    
      <i class="iconfont icon-tag">
        <a rel="tag" href = /ios.github.io/tags/swift/ >swift</a>
      </i>
    
  </div>

  
  <div class="mdui-card-content mdui-typo mdui-p-x-4">
    <h1 id="Swift学习日记（六）：枚举与协议"><a href="#Swift学习日记（六）：枚举与协议" class="headerlink" title="Swift学习日记（六）：枚举与协议"></a>Swift学习日记（六）：枚举与协议</h1><h2 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h2><p>在上一篇学习日记中，我们已经了解了Swift的类和结构体，这是面向对象编程的基础。在这篇日记中，我们将继续探讨Swift的两个重要特性：枚举和协议。枚举用于定义一组相关的值，协议用于定义方法、属性和其他要求的蓝图，它们都是Swift面向对象编程的重要组成部分。</p>
<h2 id="二、枚举的定义与使用"><a href="#二、枚举的定义与使用" class="headerlink" title="二、枚举的定义与使用"></a>二、枚举的定义与使用</h2><p>枚举（Enumeration）是一种数据类型，用于定义一组相关的值。Swift的枚举比其他语言的枚举更加强大，可以包含关联值、原始值和方法。</p>
<h3 id="1-基本枚举定义"><a href="#1-基本枚举定义" class="headerlink" title="1. 基本枚举定义"></a>1. 基本枚举定义</h3><p>枚举的定义使用<code>enum</code>关键字：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个枚举</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> north</span><br><span class="line">    <span class="keyword">case</span> south</span><br><span class="line">    <span class="keyword">case</span> east</span><br><span class="line">    <span class="keyword">case</span> west</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建枚举实例</span></span><br><span class="line"><span class="keyword">var</span> direction <span class="operator">=</span> <span class="type">Direction</span>.north</span><br><span class="line"></span><br><span class="line"><span class="comment">// 由于Swift的类型推断，可以省略枚举名称</span></span><br><span class="line">direction <span class="operator">=</span> .south</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用switch语句匹配枚举值</span></span><br><span class="line"><span class="keyword">switch</span> direction &#123;</span><br><span class="line"><span class="keyword">case</span> .north:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;向北&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> .south:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;向南&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> .east:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;向东&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> .west:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;向西&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也可以在一行中定义多个枚举成员：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> north, south, east, west</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-关联值"><a href="#2-关联值" class="headerlink" title="2. 关联值"></a>2. 关联值</h3><p>Swift的枚举可以为成员添加关联值，关联值可以是不同类型的：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个包含关联值的枚举</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Barcode</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> upc(<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> qrCode(<span class="type">String</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建包含关联值的枚举实例</span></span><br><span class="line"><span class="keyword">var</span> productBarcode <span class="operator">=</span> <span class="type">Barcode</span>.upc(<span class="number">8</span>, <span class="number">85909</span>, <span class="number">51226</span>, <span class="number">3</span>)</span><br><span class="line">productBarcode <span class="operator">=</span> .qrCode(<span class="string">&quot;ABCDEFGHIJKLMNOP&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配关联值</span></span><br><span class="line"><span class="keyword">switch</span> productBarcode &#123;</span><br><span class="line"><span class="keyword">case</span> .upc(<span class="keyword">let</span> numberSystem, <span class="keyword">let</span> manufacturer, <span class="keyword">let</span> product, <span class="keyword">let</span> check):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;UPC: <span class="subst">\(numberSystem)</span>-<span class="subst">\(manufacturer)</span>-<span class="subst">\(product)</span>-<span class="subst">\(check)</span>&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> .qrCode(<span class="keyword">let</span> productCode):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;QR Code: <span class="subst">\(productCode)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出：QR Code: ABCDEFGHIJKLMNOP</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果所有关联值都需要被提取，可以将let或var放在case前面</span></span><br><span class="line"><span class="keyword">switch</span> productBarcode &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .upc(numberSystem, manufacturer, product, check):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;UPC: <span class="subst">\(numberSystem)</span>-<span class="subst">\(manufacturer)</span>-<span class="subst">\(product)</span>-<span class="subst">\(check)</span>&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> .qrCode(productCode):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;QR Code: <span class="subst">\(productCode)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出：QR Code: ABCDEFGHIJKLMNOP</span></span><br></pre></td></tr></table></figure>

<h3 id="3-原始值"><a href="#3-原始值" class="headerlink" title="3. 原始值"></a>3. 原始值</h3><p>枚举成员可以设置原始值，原始值的类型必须相同：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个包含原始值的枚举</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Planet</span>: <span class="title class_ inherited__">Int</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> mercury <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> venus</span><br><span class="line">    <span class="keyword">case</span> earth</span><br><span class="line">    <span class="keyword">case</span> mars</span><br><span class="line">    <span class="keyword">case</span> jupiter</span><br><span class="line">    <span class="keyword">case</span> saturn</span><br><span class="line">    <span class="keyword">case</span> uranus</span><br><span class="line">    <span class="keyword">case</span> neptune</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问枚举成员的原始值</span></span><br><span class="line"><span class="keyword">let</span> earthsOrder <span class="operator">=</span> <span class="type">Planet</span>.earth.rawValue <span class="comment">// 输出：3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用原始值初始化枚举实例</span></span><br><span class="line"><span class="keyword">let</span> possiblePlanet <span class="operator">=</span> <span class="type">Planet</span>(rawValue: <span class="number">7</span>) <span class="comment">// 返回Planet.uranus</span></span><br><span class="line"><span class="keyword">let</span> impossiblePlanet <span class="operator">=</span> <span class="type">Planet</span>(rawValue: <span class="number">10</span>) <span class="comment">// 返回nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串原始值</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">CompassPoint</span>: <span class="title class_ inherited__">String</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> north <span class="operator">=</span> <span class="string">&quot;North&quot;</span></span><br><span class="line">    <span class="keyword">case</span> south <span class="operator">=</span> <span class="string">&quot;South&quot;</span></span><br><span class="line">    <span class="keyword">case</span> east <span class="operator">=</span> <span class="string">&quot;East&quot;</span></span><br><span class="line">    <span class="keyword">case</span> west <span class="operator">=</span> <span class="string">&quot;West&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> northDirection <span class="operator">=</span> <span class="type">CompassPoint</span>.north.rawValue <span class="comment">// 输出：&quot;North&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-递归枚举"><a href="#4-递归枚举" class="headerlink" title="4. 递归枚举"></a>4. 递归枚举</h3><p>递归枚举是指枚举成员可以关联一个包含该枚举类型的值，使用<code>indirect</code>关键字定义：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个递归枚举</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">ArithmeticExpression</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> number(<span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">indirect</span> <span class="keyword">case</span> addition(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">    <span class="keyword">indirect</span> <span class="keyword">case</span> multiplication(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以将indirect放在枚举定义前面</span></span><br><span class="line">def <span class="keyword">indirect</span> <span class="keyword">enum</span> <span class="title class_">ArithmeticExpression</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> number(<span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> addition(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">    <span class="keyword">case</span> multiplication(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建递归枚举实例</span></span><br><span class="line"><span class="keyword">let</span> five <span class="operator">=</span> <span class="type">ArithmeticExpression</span>.number(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">let</span> four <span class="operator">=</span> <span class="type">ArithmeticExpression</span>.number(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">let</span> sum <span class="operator">=</span> <span class="type">ArithmeticExpression</span>.addition(five, four)</span><br><span class="line"><span class="keyword">let</span> product <span class="operator">=</span> <span class="type">ArithmeticExpression</span>.multiplication(sum, <span class="type">ArithmeticExpression</span>.number(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算表达式的值</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">evaluate</span>(<span class="keyword">_</span> <span class="params">expression</span>: <span class="type">ArithmeticExpression</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> expression &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .number(value):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .addition(left, right):</span><br><span class="line">        <span class="keyword">return</span> evaluate(left) <span class="operator">+</span> evaluate(right)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .multiplication(left, right):</span><br><span class="line">        <span class="keyword">return</span> evaluate(left) <span class="operator">*</span> evaluate(right)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(evaluate(product)) <span class="comment">// 输出：18</span></span><br></pre></td></tr></table></figure>

<h3 id="5-枚举的方法"><a href="#5-枚举的方法" class="headerlink" title="5. 枚举的方法"></a>5. 枚举的方法</h3><p>Swift的枚举可以包含方法：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> north, south, east, west</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 实例方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">description</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .north:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;北方&quot;</span></span><br><span class="line">        <span class="keyword">case</span> .south:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;南方&quot;</span></span><br><span class="line">        <span class="keyword">case</span> .east:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;东方&quot;</span></span><br><span class="line">        <span class="keyword">case</span> .west:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;西方&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 类型方法</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">allDirections</span>() -&gt; [<span class="type">Direction</span>] &#123;</span><br><span class="line">        <span class="keyword">return</span> [.north, .south, .east, .west]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> direction <span class="operator">=</span> <span class="type">Direction</span>.north</span><br><span class="line"><span class="built_in">print</span>(direction.description()) <span class="comment">// 输出：北方</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> allDirections <span class="operator">=</span> <span class="type">Direction</span>.allDirections()</span><br><span class="line"><span class="keyword">for</span> dir <span class="keyword">in</span> allDirections &#123;</span><br><span class="line">    <span class="built_in">print</span>(dir.description())</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出：</span></span><br><span class="line"><span class="comment">// 北方</span></span><br><span class="line"><span class="comment">// 南方</span></span><br><span class="line"><span class="comment">// 东方</span></span><br><span class="line"><span class="comment">// 西方</span></span><br></pre></td></tr></table></figure>

<h2 id="三、协议的定义与使用"><a href="#三、协议的定义与使用" class="headerlink" title="三、协议的定义与使用"></a>三、协议的定义与使用</h2><p>协议（Protocol）是一种定义方法、属性和其他要求的蓝图，它本身不提供实现，而是由类、结构体或枚举来遵循和实现。</p>
<h3 id="1-基本协议定义"><a href="#1-基本协议定义" class="headerlink" title="1. 基本协议定义"></a>1. 基本协议定义</h3><p>协议的定义使用<code>protocol</code>关键字：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanGreet</span> &#123;</span><br><span class="line">    <span class="comment">// 要求实现一个方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 要求实现一个属性</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类遵循协议</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>: <span class="title class_ inherited__">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 实现协议要求的方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你好，我是<span class="subst">\(name)</span>。&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构体遵循协议</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Student</span>: <span class="title class_ inherited__">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 实现协议要求的方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你好，我是学生<span class="subst">\(name)</span>。&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用协议类型</span></span><br><span class="line"><span class="keyword">let</span> person: <span class="type">CanGreet</span> <span class="operator">=</span> <span class="type">Person</span>(name: <span class="string">&quot;张三&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> student: <span class="type">CanGreet</span> <span class="operator">=</span> <span class="type">Student</span>(name: <span class="string">&quot;李四&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(person.greet()) <span class="comment">// 输出：你好，我是张三。</span></span><br><span class="line"><span class="built_in">print</span>(student.greet()) <span class="comment">// 输出：你好，我是学生李四。</span></span><br></pre></td></tr></table></figure>

<h3 id="2-协议的属性要求"><a href="#2-协议的属性要求" class="headerlink" title="2. 协议的属性要求"></a>2. 协议的属性要求</h3><p>协议可以要求遵循者实现特定的属性：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Named</span> &#123;</span><br><span class="line">    <span class="comment">// 只读属性</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 读写属性</span></span><br><span class="line">    <span class="keyword">var</span> fullName: <span class="type">String</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span>: <span class="title class_ inherited__">Named</span> &#123;</span><br><span class="line">    <span class="comment">// 存储属性可以同时满足get和set要求</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> fullName: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>: <span class="title class_ inherited__">Named</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> fullName: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>, <span class="params">fullName</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">        <span class="keyword">self</span>.fullName <span class="operator">=</span> fullName</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-协议的方法要求"><a href="#3-协议的方法要求" class="headerlink" title="3. 协议的方法要求"></a>3. 协议的方法要求</h3><p>协议可以要求遵循者实现特定的方法：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">IntStack</span> &#123;</span><br><span class="line">    <span class="comment">// 要求实现一个方法</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">Int</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 要求实现另一个方法</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Int</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 要求实现一个只读计算属性</span></span><br><span class="line">    <span class="keyword">var</span> count: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Stack</span>: <span class="title class_ inherited__">IntStack</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> items <span class="operator">=</span> [<span class="type">Int</span>]()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">Int</span>) &#123;</span><br><span class="line">        items.append(item)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Int</span>? &#123;</span><br><span class="line">        <span class="keyword">return</span> items.popLast()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> count: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> items.count</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>()</span><br><span class="line">stack.push(<span class="number">1</span>)</span><br><span class="line">stack.push(<span class="number">2</span>)</span><br><span class="line">stack.push(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(stack.count) <span class="comment">// 输出：3</span></span><br><span class="line"><span class="built_in">print</span>(stack.pop()) <span class="comment">// 输出：Optional(3)</span></span><br><span class="line"><span class="built_in">print</span>(stack.count) <span class="comment">// 输出：2</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：如果协议方法会修改结构体或枚举的实例，需要在协议方法要求前加上<code>mutating</code>关键字。</p>
<h3 id="4-协议继承"><a href="#4-协议继承" class="headerlink" title="4. 协议继承"></a>4. 协议继承</h3><p>协议可以继承一个或多个其他协议：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个基础协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanWalk</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">walk</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义另一个基础协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanTalk</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">talk</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承两个协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanWalkAndTalk</span>: <span class="title class_ inherited__">CanWalk</span>, <span class="title class_ inherited__">CanTalk</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">introduce</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵循继承的协议</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>: <span class="title class_ inherited__">CanWalkAndTalk</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">walk</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;走路&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">talk</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;说话&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">introduce</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;你好，我是一个人。&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person <span class="operator">=</span> <span class="type">Person</span>()</span><br><span class="line">person.walk()</span><br><span class="line">person.talk()</span><br><span class="line">person.introduce()</span><br></pre></td></tr></table></figure>

<h3 id="5-协议组合"><a href="#5-协议组合" class="headerlink" title="5. 协议组合"></a>5. 协议组合</h3><p>协议组合允许将多个协议组合成一个临时协议，使用<code>&amp;</code>符号：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanEat</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">eat</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanSleep</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">sleep</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>: <span class="title class_ inherited__">CanEat</span>, <span class="title class_ inherited__">CanSleep</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">eat</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;吃饭&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">sleep</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;睡觉&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用协议组合</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">performActions</span>(<span class="params">on</span> <span class="params">creature</span>: <span class="type">CanEat</span> &amp; <span class="type">CanSleep</span>) &#123;</span><br><span class="line">    creature.eat()</span><br><span class="line">    creature.sleep()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person <span class="operator">=</span> <span class="type">Person</span>()</span><br><span class="line">performActions(on: person)</span><br></pre></td></tr></table></figure>

<h3 id="6-可选协议要求"><a href="#6-可选协议要求" class="headerlink" title="6. 可选协议要求"></a>6. 可选协议要求</h3><p>可选协议要求允许遵循者选择是否实现特定的方法或属性，使用<code>@objc</code>关键字标记协议，并使用<code>optional</code>关键字标记可选要求：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span> <span class="keyword">protocol</span> <span class="title class_">OptionalProtocol</span> &#123;</span><br><span class="line">    <span class="comment">// 必需实现的方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">requiredMethod</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 可选实现的方法</span></span><br><span class="line">    <span class="keyword">@objc</span> <span class="keyword">optional</span> <span class="keyword">func</span> <span class="title function_">optionalMethod</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 可选实现的属性</span></span><br><span class="line">    <span class="keyword">@objc</span> <span class="keyword">optional</span> <span class="keyword">var</span> optionalProperty: <span class="type">String</span> &#123; <span class="keyword">get</span> <span class="keyword">set</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>: <span class="title class_ inherited__">OptionalProtocol</span> &#123;</span><br><span class="line">    <span class="comment">// 必须实现这个方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">requiredMethod</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;实现了必需方法&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 可以选择不实现可选方法和属性</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myClass <span class="operator">=</span> <span class="type">MyClass</span>()</span><br><span class="line">myClass.requiredMethod()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用可选方法前需要检查是否实现</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> optionalMethod <span class="operator">=</span> myClass.optionalMethod &#123;</span><br><span class="line">    optionalMethod()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>：可选协议要求只能用于类，不能用于结构体或枚举。</p>
<h3 id="7-协议扩展"><a href="#7-协议扩展" class="headerlink" title="7. 协议扩展"></a>7. 协议扩展</h3><p>协议扩展允许为协议添加默认实现，遵循者可以选择重写或使用默认实现：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展协议，添加默认实现</span></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你好，我是<span class="subst">\(name)</span>。&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加新方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greetWithMessage</span>(<span class="keyword">_</span> <span class="params">message</span>: <span class="type">String</span>) -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;<span class="subst">\(message)</span>，我是<span class="subst">\(name)</span>。&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span>: <span class="title class_ inherited__">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 使用默认实现的greet方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>: <span class="title class_ inherited__">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 重写默认实现</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你好，我是学生<span class="subst">\(name)</span>。&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person <span class="operator">=</span> <span class="type">Person</span>(name: <span class="string">&quot;张三&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(person.greet()) <span class="comment">// 输出：你好，我是张三。</span></span><br><span class="line"><span class="built_in">print</span>(person.greetWithMessage(<span class="string">&quot;大家好&quot;</span>)) <span class="comment">// 输出：大家好，我是张三。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> student <span class="operator">=</span> <span class="type">Student</span>(name: <span class="string">&quot;李四&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(student.greet()) <span class="comment">// 输出：你好，我是学生李四。</span></span><br><span class="line"><span class="built_in">print</span>(student.greetWithMessage(<span class="string">&quot;大家好&quot;</span>)) <span class="comment">// 输出：大家好，我是学生李四。</span></span><br></pre></td></tr></table></figure>

<h2 id="四、协议的应用场景"><a href="#四、协议的应用场景" class="headerlink" title="四、协议的应用场景"></a>四、协议的应用场景</h2><p>协议在Swift中有很多应用场景，下面介绍几个常见的应用场景：</p>
<h3 id="1-委托模式"><a href="#1-委托模式" class="headerlink" title="1. 委托模式"></a>1. 委托模式</h3><p>委托模式是一种设计模式，用于将一个类或结构体的责任委托给另一个类或结构体。协议通常用于定义委托的接口：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义委托协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">UserInputDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">userDidInputText</span>(<span class="keyword">_</span> <span class="params">text</span>: <span class="type">String</span>)</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">userDidPressButton</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个类，使用委托</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInputView</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> delegate: <span class="type">UserInputDelegate</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">textFieldDidChange</span>(<span class="keyword">_</span> <span class="params">text</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        delegate<span class="operator">?</span>.userDidInputText(text)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">buttonDidPress</span>() &#123;</span><br><span class="line">        delegate<span class="operator">?</span>.userDidPressButton()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遵循委托协议</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UserInputDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> inputView <span class="operator">=</span> <span class="type">UserInputView</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="comment">// 设置委托</span></span><br><span class="line">        inputView.delegate <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 实现委托方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">userDidInputText</span>(<span class="keyword">_</span> <span class="params">text</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用户输入了：<span class="subst">\(text)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">userDidPressButton</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用户按下了按钮&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> viewController <span class="operator">=</span> <span class="type">ViewController</span>()</span><br><span class="line">viewController.inputView.textFieldDidChange(<span class="string">&quot;Hello&quot;</span>) <span class="comment">// 输出：用户输入了：Hello</span></span><br><span class="line">viewController.inputView.buttonDidPress() <span class="comment">// 输出：用户按下了按钮</span></span><br></pre></td></tr></table></figure>

<h3 id="2-多态"><a href="#2-多态" class="headerlink" title="2. 多态"></a>2. 多态</h3><p>协议可以用于实现多态，允许不同类型的对象以统一的方式处理：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">perimeter</span>() -&gt; <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Circle</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> radius: <span class="type">Double</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Double</span>.pi <span class="operator">*</span> radius <span class="operator">*</span> radius</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">perimeter</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> <span class="operator">*</span> <span class="type">Double</span>.pi <span class="operator">*</span> radius</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> width: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">var</span> height: <span class="type">Double</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> width <span class="operator">*</span> height</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">perimeter</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> <span class="operator">*</span> (width <span class="operator">+</span> height)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用协议类型的数组</span></span><br><span class="line"><span class="keyword">let</span> shapes: [<span class="type">Shape</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="type">Circle</span>(radius: <span class="number">5.0</span>),</span><br><span class="line">    <span class="type">Rectangle</span>(width: <span class="number">3.0</span>, height: <span class="number">4.0</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多态调用</span></span><br><span class="line"><span class="keyword">for</span> shape <span class="keyword">in</span> shapes &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;面积：<span class="subst">\(shape.area())</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;周长：<span class="subst">\(shape.perimeter())</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="五、内容机制与知识点总结"><a href="#五、内容机制与知识点总结" class="headerlink" title="五、内容机制与知识点总结"></a>五、内容机制与知识点总结</h2><h3 id="1-Swift枚举与协议的设计原则"><a href="#1-Swift枚举与协议的设计原则" class="headerlink" title="1. Swift枚举与协议的设计原则"></a>1. Swift枚举与协议的设计原则</h3><p>Swift的枚举与协议体现了几个核心设计原则：</p>
<ul>
<li><strong>类型安全</strong>：通过严格的类型定义确保代码的可靠性</li>
<li><strong>抽象与复用</strong>：协议提供了一种抽象机制，允许不同类型共享相同的接口</li>
<li><strong>灵活性</strong>：枚举支持关联值和原始值，提供了灵活的数据建模方式</li>
<li><strong>组合优于继承</strong>：协议支持多继承和组合，比类的单继承更加灵活</li>
<li><strong>默认实现</strong>：协议扩展允许为协议方法提供默认实现，提高代码复用性</li>
</ul>
<h3 id="2-核心知识点总结"><a href="#2-核心知识点总结" class="headerlink" title="2. 核心知识点总结"></a>2. 核心知识点总结</h3><table>
<thead>
<tr>
<th>概念</th>
<th>描述</th>
<th>主要特性</th>
</tr>
</thead>
<tbody><tr>
<td>枚举基本定义</td>
<td>使用<code>enum</code>关键字定义一组相关的值</td>
<td>支持多种成员值定义方式</td>
</tr>
<tr>
<td>关联值</td>
<td>枚举成员可以关联不同类型的值</td>
<td>允许枚举承载额外信息</td>
</tr>
<tr>
<td>原始值</td>
<td>枚举成员可以有相同类型的默认值</td>
<td>支持自动递增原始值</td>
</tr>
<tr>
<td>递归枚举</td>
<td>枚举成员可以关联包含自身类型的值</td>
<td>使用<code>indirect</code>关键字标记</td>
</tr>
<tr>
<td>枚举方法</td>
<td>枚举可以包含实例方法和类型方法</td>
<td>增强枚举的功能性</td>
</tr>
<tr>
<td>协议基本定义</td>
<td>使用<code>protocol</code>关键字定义接口蓝图</td>
<td>定义方法和属性要求</td>
</tr>
<tr>
<td>协议继承</td>
<td>协议可以继承一个或多个其他协议</td>
<td>支持多继承</td>
</tr>
<tr>
<td>协议组合</td>
<td>将多个协议组合成临时协议</td>
<td>使用<code>&amp;</code>符号组合</td>
</tr>
<tr>
<td>可选协议</td>
<td>允许遵循者选择是否实现某些要求</td>
<td>使用<code>@objc optional</code>标记</td>
</tr>
<tr>
<td>协议扩展</td>
<td>为协议添加默认实现和新方法</td>
<td>提高代码复用性</td>
</tr>
<tr>
<td>委托模式</td>
<td>通过协议将责任委托给其他对象</td>
<td>实现对象间的松耦合通信</td>
</tr>
<tr>
<td>多态</td>
<td>通过协议类型实现多态行为</td>
<td>统一处理不同类型的对象</td>
</tr>
</tbody></table>
<h2 id="六、遇到的问题及解决方案"><a href="#六、遇到的问题及解决方案" class="headerlink" title="六、遇到的问题及解决方案"></a>六、遇到的问题及解决方案</h2><h3 id="1-枚举成员名称与系统类型冲突"><a href="#1-枚举成员名称与系统类型冲突" class="headerlink" title="1. 枚举成员名称与系统类型冲突"></a>1. 枚举成员名称与系统类型冲突</h3><p><strong>问题</strong>：定义枚举成员时，名称与系统类型或函数冲突。</p>
<p><strong>解决方案</strong>：使用前缀或更具体的名称，或者使用命名空间。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 冲突示例</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> success</span><br><span class="line">    <span class="keyword">case</span> failure</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 可能与Swift标准库中的Result冲突</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 解决方案：使用前缀或更具体的名称</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">OperationResult</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> success</span><br><span class="line">    <span class="keyword">case</span> failure</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或使用命名空间</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Network</span> &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> success</span><br><span class="line">        <span class="keyword">case</span> failure</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-协议方法未实现导致编译错误"><a href="#2-协议方法未实现导致编译错误" class="headerlink" title="2. 协议方法未实现导致编译错误"></a>2. 协议方法未实现导致编译错误</h3><p><strong>问题</strong>：遵循协议时，忘记实现某些必需的方法或属性。</p>
<p><strong>解决方案</strong>：仔细检查协议要求，确保所有必需的方法和属性都已实现。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">perimeter</span>() -&gt; <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Circle</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> radius: <span class="type">Double</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 忘记实现perimeter()方法，会导致编译错误</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Double</span>.pi <span class="operator">*</span> radius <span class="operator">*</span> radius</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加缺失的实现</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">perimeter</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> <span class="operator">*</span> <span class="type">Double</span>.pi <span class="operator">*</span> radius</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-协议扩展中的默认实现未被调用"><a href="#3-协议扩展中的默认实现未被调用" class="headerlink" title="3. 协议扩展中的默认实现未被调用"></a>3. 协议扩展中的默认实现未被调用</h3><p><strong>问题</strong>：遵循协议的类型实现了协议方法，但希望在某些情况下调用默认实现。</p>
<p><strong>解决方案</strong>：在类型的实现中显式调用协议的默认实现。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你好，我是<span class="subst">\(name)</span>。&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>: <span class="title class_ inherited__">CanGreet</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">name</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name <span class="operator">=</span> name</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">greet</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="comment">// 先调用默认实现</span></span><br><span class="line">        <span class="keyword">let</span> defaultGreeting <span class="operator">=</span> (<span class="keyword">self</span> <span class="keyword">as</span> <span class="type">CanGreet</span>).greet()</span><br><span class="line">        <span class="comment">// 再添加额外逻辑</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;学生：<span class="subst">\(defaultGreeting)</span>&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-递归枚举导致栈溢出"><a href="#4-递归枚举导致栈溢出" class="headerlink" title="4. 递归枚举导致栈溢出"></a>4. 递归枚举导致栈溢出</h3><p><strong>问题</strong>：复杂的递归枚举表达式可能导致栈溢出。</p>
<p><strong>解决方案</strong>：优化递归算法，或考虑使用迭代方式替代递归。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ArithmeticExpression</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> number(<span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">indirect</span> <span class="keyword">case</span> addition(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">    <span class="keyword">indirect</span> <span class="keyword">case</span> multiplication(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化前可能导致栈溢出</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">evaluate</span>(<span class="keyword">_</span> <span class="params">expression</span>: <span class="type">ArithmeticExpression</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> expression &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .number(value):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .addition(left, right):</span><br><span class="line">        <span class="keyword">return</span> evaluate(left) <span class="operator">+</span> evaluate(right)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .multiplication(left, right):</span><br><span class="line">        <span class="keyword">return</span> evaluate(left) <span class="operator">*</span> evaluate(right)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化后使用迭代方式</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">evaluateIterative</span>(<span class="keyword">_</span> <span class="params">expression</span>: <span class="type">ArithmeticExpression</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> stack <span class="operator">=</span> [expression]</span><br><span class="line">    <span class="keyword">var</span> values <span class="operator">=</span> [<span class="type">Int</span>]()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="operator">!</span>stack.isEmpty &#123;</span><br><span class="line">        <span class="keyword">let</span> current <span class="operator">=</span> stack.removeLast()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">switch</span> current &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .number(value):</span><br><span class="line">            values.append(value)</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .addition(left, right):</span><br><span class="line">            stack.append(current)</span><br><span class="line">            stack.append(right)</span><br><span class="line">            stack.append(left)</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .multiplication(left, right):</span><br><span class="line">            stack.append(current)</span><br><span class="line">            stack.append(right)</span><br><span class="line">            stack.append(left)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 处理可以计算的表达式</span></span><br><span class="line">        <span class="keyword">if</span> stack.count <span class="operator">&gt;=</span> <span class="number">3</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> third <span class="operator">=</span> stack[stack.count <span class="operator">-</span> <span class="number">3</span>]</span><br><span class="line">            <span class="keyword">let</span> second <span class="operator">=</span> stack[stack.count <span class="operator">-</span> <span class="number">2</span>]</span><br><span class="line">            <span class="keyword">let</span> first <span class="operator">=</span> stack[stack.count <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">case</span> .number <span class="operator">=</span> first, <span class="keyword">case</span> .number <span class="operator">=</span> second &#123;</span><br><span class="line">                <span class="keyword">let</span> a <span class="operator">=</span> values.removeLast()</span><br><span class="line">                <span class="keyword">let</span> b <span class="operator">=</span> values.removeLast()</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">switch</span> third &#123;</span><br><span class="line">                <span class="keyword">case</span> .addition:</span><br><span class="line">                    values.append(a <span class="operator">+</span> b)</span><br><span class="line">                    stack.removeLast(<span class="number">3</span>)</span><br><span class="line">                    stack.append(.number(a <span class="operator">+</span> b))</span><br><span class="line">                <span class="keyword">case</span> .multiplication:</span><br><span class="line">                    values.append(a <span class="operator">*</span> b)</span><br><span class="line">                    stack.removeLast(<span class="number">3</span>)</span><br><span class="line">                    stack.append(.number(a <span class="operator">*</span> b))</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> values.first <span class="operator">??</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-委托循环引用"><a href="#5-委托循环引用" class="headerlink" title="5. 委托循环引用"></a>5. 委托循环引用</h3><p><strong>问题</strong>：委托模式中，委托对象和被委托对象之间可能形成循环引用。</p>
<p><strong>解决方案</strong>：在委托属性上使用<code>weak</code>关键字。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">UserInputDelegate</span>: <span class="title class_ inherited__">AnyObject</span> &#123; <span class="comment">// 限制为类协议</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">userDidInputText</span>(<span class="keyword">_</span> <span class="params">text</span>: <span class="type">String</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInputView</span> &#123;</span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">UserInputDelegate</span>? <span class="comment">// 使用weak避免循环引用</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">textFieldDidChange</span>(<span class="keyword">_</span> <span class="params">text</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        delegate<span class="operator">?</span>.userDidInputText(text)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UserInputDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> inputView <span class="operator">=</span> <span class="type">UserInputView</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        inputView.delegate <span class="operator">=</span> <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">userDidInputText</span>(<span class="keyword">_</span> <span class="params">text</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用户输入：<span class="subst">\(text)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="七、高阶用法"><a href="#七、高阶用法" class="headerlink" title="七、高阶用法"></a>七、高阶用法</h2><h3 id="1-高级枚举技巧"><a href="#1-高级枚举技巧" class="headerlink" title="1. 高级枚举技巧"></a>1. 高级枚举技巧</h3><h4 id="1-1-枚举与泛型结合"><a href="#1-1-枚举与泛型结合" class="headerlink" title="1.1 枚举与泛型结合"></a>1.1 枚举与泛型结合</h4><p>将枚举与泛型结合，可以创建更灵活的数据结构。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Result</span>&lt;<span class="type">T</span>, <span class="type">E</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">case</span> success(<span class="type">T</span>)</span><br><span class="line">    <span class="keyword">case</span> failure(<span class="type">E</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用泛型枚举</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">fetchData</span>() -&gt; <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">Error</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="comment">// 模拟成功获取数据</span></span><br><span class="line">        <span class="keyword">let</span> data <span class="operator">=</span> <span class="string">&quot;成功获取的数据&quot;</span></span><br><span class="line">        <span class="keyword">return</span> .success(data)</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> .failure(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result <span class="operator">=</span> fetchData()</span><br><span class="line"><span class="keyword">switch</span> result &#123;</span><br><span class="line"><span class="keyword">case</span> .success(<span class="keyword">let</span> data):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;数据：<span class="subst">\(data)</span>&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;错误：<span class="subst">\(error)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-枚举与协议结合"><a href="#1-2-枚举与协议结合" class="headerlink" title="1.2 枚举与协议结合"></a>1.2 枚举与协议结合</h4><p>枚举可以遵循协议，增强其功能。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">CustomStringConvertible</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span>: <span class="title class_ inherited__">CustomStringConvertible</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> north, south, east, west</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .north:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;北&quot;</span></span><br><span class="line">        <span class="keyword">case</span> .south:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;南&quot;</span></span><br><span class="line">        <span class="keyword">case</span> .east:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;东&quot;</span></span><br><span class="line">        <span class="keyword">case</span> .west:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;西&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> direction <span class="operator">=</span> <span class="type">Direction</span>.north</span><br><span class="line"><span class="built_in">print</span>(direction) <span class="comment">// 输出：北</span></span><br></pre></td></tr></table></figure>

<h4 id="1-3-枚举与扩展结合"><a href="#1-3-枚举与扩展结合" class="headerlink" title="1.3 枚举与扩展结合"></a>1.3 枚举与扩展结合</h4><p>使用扩展为枚举添加新功能，保持代码整洁。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Weekday</span>: <span class="title class_ inherited__">Int</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> monday <span class="operator">=</span> <span class="number">1</span>, tuesday, wednesday, thursday, friday, saturday, sunday</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用扩展添加功能</span></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Weekday</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> isWeekend: <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span> <span class="operator">==</span> .saturday <span class="operator">||</span> <span class="keyword">self</span> <span class="operator">==</span> .sunday</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> names <span class="operator">=</span> [<span class="string">&quot;周一&quot;</span>, <span class="string">&quot;周二&quot;</span>, <span class="string">&quot;周三&quot;</span>, <span class="string">&quot;周四&quot;</span>, <span class="string">&quot;周五&quot;</span>, <span class="string">&quot;周六&quot;</span>, <span class="string">&quot;周日&quot;</span>]</span><br><span class="line">        <span class="keyword">return</span> names[rawValue <span class="operator">-</span> <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">nextDay</span>() -&gt; <span class="type">Weekday</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> nextRawValue <span class="operator">=</span> (rawValue <span class="operator">%</span> <span class="number">7</span>) <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">Weekday</span>(rawValue: nextRawValue)<span class="operator">!</span> <span class="comment">// 安全解包，因为nextRawValue范围是1-7</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> today <span class="operator">=</span> <span class="type">Weekday</span>.monday</span><br><span class="line"><span class="built_in">print</span>(today.isWeekend) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">print</span>(today.name) <span class="comment">// 周一</span></span><br><span class="line"><span class="built_in">print</span>(today.nextDay().name) <span class="comment">// 周二</span></span><br></pre></td></tr></table></figure>

<h3 id="2-高级协议技巧"><a href="#2-高级协议技巧" class="headerlink" title="2. 高级协议技巧"></a>2. 高级协议技巧</h3><h4 id="2-1-泛型协议"><a href="#2-1-泛型协议" class="headerlink" title="2.1 泛型协议"></a>2.1 泛型协议</h4><p>使用泛型协议定义更通用的接口。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Container</span>&lt;<span class="type">Element</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> count: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">Element</span>)</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="params">at</span> <span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Element</span>?</span><br><span class="line">    <span class="keyword">subscript</span>(<span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Element</span>? &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Stack</span>&lt;<span class="type">Element</span>&gt;: <span class="title class_ inherited__">Container</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> items <span class="operator">=</span> [<span class="type">Element</span>]()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> count: <span class="type">Int</span> &#123; items.count &#125;</span><br><span class="line">    <span class="keyword">var</span> isEmpty: <span class="type">Bool</span> &#123; items.isEmpty &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">append</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">Element</span>) &#123;</span><br><span class="line">        items.append(item)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">remove</span>(<span class="params">at</span> <span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">        <span class="keyword">guard</span> index <span class="operator">&gt;=</span> <span class="number">0</span> <span class="operator">&amp;&amp;</span> index <span class="operator">&lt;</span> items.count <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> items.remove(at: index)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">subscript</span>(<span class="params">index</span>: <span class="type">Int</span>) -&gt; <span class="type">Element</span>? &#123;</span><br><span class="line">        <span class="keyword">guard</span> index <span class="operator">&gt;=</span> <span class="number">0</span> <span class="operator">&amp;&amp;</span> index <span class="operator">&lt;</span> items.count <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> items[index]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">stack.append(<span class="number">1</span>)</span><br><span class="line">stack.append(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(stack[<span class="number">0</span>]) <span class="comment">// Optional(1)</span></span><br><span class="line"><span class="built_in">print</span>(stack.remove(at: <span class="number">1</span>)) <span class="comment">// Optional(2)</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-协议的条件扩展"><a href="#2-2-协议的条件扩展" class="headerlink" title="2.2 协议的条件扩展"></a>2.2 协议的条件扩展</h4><p>根据泛型类型的约束为协议添加扩展。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">Container</span> <span class="keyword">where</span> <span class="type">Element</span>: <span class="type">Equatable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">contains</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">Element</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span>count &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">self</span>[i] <span class="operator">==</span> item &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> intStack <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">intStack.append(<span class="number">1</span>)</span><br><span class="line">intStack.append(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(intStack.contains(<span class="number">1</span>)) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">print</span>(intStack.contains(<span class="number">3</span>)) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h4 id="2-3-协议的关联类型约束"><a href="#2-3-协议的关联类型约束" class="headerlink" title="2.3 协议的关联类型约束"></a>2.3 协议的关联类型约束</h4><p>为协议的关联类型添加约束，增强类型安全性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">OrderedContainer</span>: <span class="title class_ inherited__">Container</span> <span class="keyword">where</span> <span class="title class_ inherited__">Element</span>: <span class="title class_ inherited__">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">sort</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Stack</span>: <span class="title class_ inherited__">OrderedContainer</span> <span class="keyword">where</span> <span class="title class_ inherited__">Element</span>: <span class="title class_ inherited__">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">sort</span>() &#123;</span><br><span class="line">        items.sort()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> numbers <span class="operator">=</span> <span class="type">Stack</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">numbers.append(<span class="number">3</span>)</span><br><span class="line">numbers.append(<span class="number">1</span>)</span><br><span class="line">numbers.append(<span class="number">2</span>)</span><br><span class="line">numbers.sort()</span><br><span class="line"><span class="built_in">print</span>(numbers[<span class="number">0</span>]) <span class="comment">// Optional(1)</span></span><br><span class="line"><span class="built_in">print</span>(numbers[<span class="number">1</span>]) <span class="comment">// Optional(2)</span></span><br><span class="line"><span class="built_in">print</span>(numbers[<span class="number">2</span>]) <span class="comment">// Optional(3)</span></span><br></pre></td></tr></table></figure>

<h3 id="3-高级委托与多态技巧"><a href="#3-高级委托与多态技巧" class="headerlink" title="3. 高级委托与多态技巧"></a>3. 高级委托与多态技巧</h3><h4 id="3-1-协议组合与类型擦除"><a href="#3-1-协议组合与类型擦除" class="headerlink" title="3.1 协议组合与类型擦除"></a>3.1 协议组合与类型擦除</h4><p>使用协议组合和类型擦除处理复杂的多态场景。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义多个协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanFly</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fly</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanSwim</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">swim</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Duck</span>: <span class="title class_ inherited__">CanFly</span>, <span class="title class_ inherited__">CanSwim</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fly</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;鸭子飞翔&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">swim</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;鸭子游泳&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Penguin</span>: <span class="title class_ inherited__">CanSwim</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">swim</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;企鹅游泳&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用协议组合</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">performActions</span>(<span class="params">on</span> <span class="params">creature</span>: <span class="type">CanFly</span> &amp; <span class="type">CanSwim</span>) &#123;</span><br><span class="line">    creature.fly()</span><br><span class="line">    creature.swim()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用类型擦除</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AnySwimmer</span>: <span class="title class_ inherited__">CanSwim</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> swimImpl: () -&gt; <span class="type">Void</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>&lt;<span class="type">T</span>: <span class="type">CanSwim</span>&gt;(<span class="keyword">_</span> <span class="params">swimmer</span>: <span class="type">T</span>) &#123;</span><br><span class="line">        swimImpl <span class="operator">=</span> swimmer.swim</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">swim</span>() &#123;</span><br><span class="line">        swimImpl()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> duck <span class="operator">=</span> <span class="type">Duck</span>()</span><br><span class="line"><span class="keyword">let</span> penguin <span class="operator">=</span> <span class="type">Penguin</span>()</span><br><span class="line"></span><br><span class="line">performActions(on: duck) <span class="comment">// 输出鸭子飞翔和游泳</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> swimmers: [<span class="type">AnySwimmer</span>] <span class="operator">=</span> [<span class="type">AnySwimmer</span>(duck), <span class="type">AnySwimmer</span>(penguin)]</span><br><span class="line"><span class="keyword">for</span> swimmer <span class="keyword">in</span> swimmers &#123;</span><br><span class="line">    swimmer.swim()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-基于协议的依赖注入"><a href="#3-2-基于协议的依赖注入" class="headerlink" title="3.2 基于协议的依赖注入"></a>3.2 基于协议的依赖注入</h4><p>使用协议实现依赖注入，提高代码的可测试性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义服务协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">DataServiceProtocol</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fetchData</span>() -&gt; <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 具体实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RealDataService</span>: <span class="title class_ inherited__">DataServiceProtocol</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fetchData</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;真实数据&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟实现（用于测试）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MockDataService</span>: <span class="title class_ inherited__">DataServiceProtocol</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fetchData</span>() -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;模拟数据&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用依赖注入的类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataProcessor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> dataService: <span class="type">DataServiceProtocol</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 通过构造函数注入依赖</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">dataService</span>: <span class="type">DataServiceProtocol</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.dataService <span class="operator">=</span> dataService</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">process</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> data <span class="operator">=</span> dataService.fetchData()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;处理数据：<span class="subst">\(data)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用真实服务</span></span><br><span class="line"><span class="keyword">let</span> realProcessor <span class="operator">=</span> <span class="type">DataProcessor</span>(dataService: <span class="type">RealDataService</span>())</span><br><span class="line">realProcessor.process() <span class="comment">// 输出：处理数据：真实数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用模拟服务（测试场景）</span></span><br><span class="line"><span class="keyword">let</span> mockProcessor <span class="operator">=</span> <span class="type">DataProcessor</span>(dataService: <span class="type">MockDataService</span>())</span><br><span class="line">mockProcessor.process() <span class="comment">// 输出：处理数据：模拟数据</span></span><br></pre></td></tr></table></figure>

<h3 id="4-性能优化策略"><a href="#4-性能优化策略" class="headerlink" title="4. 性能优化策略"></a>4. 性能优化策略</h3><h4 id="4-1-枚举的内存优化"><a href="#4-1-枚举的内存优化" class="headerlink" title="4.1 枚举的内存优化"></a>4.1 枚举的内存优化</h4><p>Swift的枚举在内存使用上非常高效，关联值的存储经过了优化。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内存优化示例：使用枚举替代类层次结构</span></span><br><span class="line"><span class="comment">// 传统方式：使用类层次结构</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123; <span class="built_in">fatalError</span>(<span class="string">&quot;未实现&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> radius: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">radius</span>: <span class="type">Double</span>) &#123; <span class="keyword">self</span>.radius <span class="operator">=</span> radius &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123; <span class="keyword">return</span> <span class="type">Double</span>.pi <span class="operator">*</span> radius <span class="operator">*</span> radius &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> width: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">let</span> height: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">width</span>: <span class="type">Double</span>, <span class="params">height</span>: <span class="type">Double</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.width <span class="operator">=</span> width</span><br><span class="line">        <span class="keyword">self</span>.height <span class="operator">=</span> height</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123; <span class="keyword">return</span> width <span class="operator">*</span> height &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化方式：使用枚举</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">OptimizedShape</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> circle(radius: <span class="type">Double</span>)</span><br><span class="line">    <span class="keyword">case</span> rectangle(width: <span class="type">Double</span>, height: <span class="type">Double</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">area</span>() -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .circle(radius):</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Double</span>.pi <span class="operator">*</span> radius <span class="operator">*</span> radius</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">let</span> .rectangle(width, height):</span><br><span class="line">            <span class="keyword">return</span> width <span class="operator">*</span> height</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 枚举方式通常比类层次结构更节省内存和CPU</span></span><br></pre></td></tr></table></figure>

<h4 id="4-2-协议扩展的性能考量"><a href="#4-2-协议扩展的性能考量" class="headerlink" title="4.2 协议扩展的性能考量"></a>4.2 协议扩展的性能考量</h4><p>使用协议扩展提供默认实现可以减少重复代码，但需要注意性能影响。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 性能优化示例：为频繁调用的方法提供高效的默认实现</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">FastProcessing</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">process</span>(<span class="params">data</span>: [<span class="type">Int</span>]) -&gt; <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 高效的默认实现</span></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">FastProcessing</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">process</span>(<span class="params">data</span>: [<span class="type">Int</span>]) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="comment">// 使用高效的实现</span></span><br><span class="line">        <span class="keyword">return</span> data.reduce(<span class="number">0</span>, <span class="operator">+</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要时可以提供更优的实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpecialProcessor</span>: <span class="title class_ inherited__">FastProcessing</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">process</span>(<span class="params">data</span>: [<span class="type">Int</span>]) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="comment">// 针对特殊情况的优化实现</span></span><br><span class="line">        <span class="keyword">var</span> sum <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> number <span class="keyword">in</span> data <span class="keyword">where</span> number <span class="operator">&gt;</span> <span class="number">0</span> &#123;</span><br><span class="line">            sum <span class="operator">+=</span> number</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-3-避免过度使用协议"><a href="#4-3-避免过度使用协议" class="headerlink" title="4.3 避免过度使用协议"></a>4.3 避免过度使用协议</h4><p>虽然协议提供了很多好处，但过度使用可能导致性能下降。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 避免不必要的协议抽象</span></span><br><span class="line"><span class="comment">// 不好的示例：为简单功能创建过多协议</span></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanAdd</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">add</span>(<span class="keyword">_</span> <span class="params">a</span>: <span class="type">Int</span>, <span class="keyword">_</span> <span class="params">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protocol</span> <span class="title class_">CanSubtract</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">subtract</span>(<span class="keyword">_</span> <span class="params">a</span>: <span class="type">Int</span>, <span class="keyword">_</span> <span class="params">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Calculator</span>: <span class="title class_ inherited__">CanAdd</span>, <span class="title class_ inherited__">CanSubtract</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">add</span>(<span class="keyword">_</span> <span class="params">a</span>: <span class="type">Int</span>, <span class="keyword">_</span> <span class="params">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123; a <span class="operator">+</span> b &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">subtract</span>(<span class="keyword">_</span> <span class="params">a</span>: <span class="type">Int</span>, <span class="keyword">_</span> <span class="params">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123; a <span class="operator">-</span> b &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更好的示例：直接实现功能</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BetterCalculator</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">add</span>(<span class="keyword">_</span> <span class="params">a</span>: <span class="type">Int</span>, <span class="keyword">_</span> <span class="params">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123; a <span class="operator">+</span> b &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">subtract</span>(<span class="keyword">_</span> <span class="params">a</span>: <span class="type">Int</span>, <span class="keyword">_</span> <span class="params">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123; a <span class="operator">-</span> b &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-最佳实践指南"><a href="#5-最佳实践指南" class="headerlink" title="5. 最佳实践指南"></a>5. 最佳实践指南</h3><ol>
<li><strong>优先使用枚举而非布尔值</strong>：枚举提供了更清晰的语义和类型安全</li>
<li><strong>合理设计协议接口</strong>：协议接口应该简洁明了，避免过多的要求</li>
<li><strong>使用协议扩展提供默认实现</strong>：减少重复代码，提高一致性</li>
<li><strong>谨慎使用可选协议</strong>：优先考虑使用协议扩展提供默认实现</li>
<li><strong>使用<code>weak</code>引用避免委托循环</strong>：确保对象能够被正确释放</li>
<li><strong>利用泛型协议提高代码复用</strong>：创建通用的、类型安全的接口</li>
<li><strong>使用协议组合替代复杂的继承层次</strong>：实现更灵活的类型系统</li>
<li><strong>为协议添加文档注释</strong>：清晰说明协议的用途和要求</li>
</ol>
<h2 id="七、实践练习"><a href="#七、实践练习" class="headerlink" title="七、实践练习"></a>七、实践练习</h2><h3 id="1-枚举基础练习"><a href="#1-枚举基础练习" class="headerlink" title="1. 枚举基础练习"></a>1. 枚举基础练习</h3><ol>
<li><p><strong>定义一个表示方向的枚举</strong>：</p>
<ul>
<li>创建一个包含东、南、西、北四个方向的枚举</li>
<li>为枚举添加计算属性<code>opposite</code>，返回相反方向</li>
<li>实现一个方法<code>turnRight</code>，返回向右转90度的方向</li>
</ul>
</li>
<li><p><strong>实现一个表示HTTP状态码的枚举</strong>：</p>
<ul>
<li>创建一个包含常见HTTP状态码的枚举（如200, 400, 404, 500等）</li>
<li>为枚举添加原始值类型为Int</li>
<li>为枚举添加计算属性<code>statusMessage</code>，返回对应状态码的描述</li>
<li>添加方法<code>isSuccess</code>，判断是否为成功状态码</li>
</ul>
</li>
</ol>
<h3 id="2-协议基础练习"><a href="#2-协议基础练习" class="headerlink" title="2. 协议基础练习"></a>2. 协议基础练习</h3><ol>
<li><p><strong>实现一个<code>Shape</code>协议</strong>：</p>
<ul>
<li>定义一个包含<code>area</code>和<code>perimeter</code>方法的协议</li>
<li>创建实现该协议的<code>Square</code>、<code>Circle</code>和<code>Triangle</code>结构体</li>
<li>为<code>Square</code>结构体添加扩展，实现一个<code>diagonal</code>方法计算对角线长度</li>
</ul>
</li>
<li><p><strong>实现一个<code>Sortable</code>协议</strong>：</p>
<ul>
<li>定义一个包含<code>sort()</code>方法的协议</li>
<li>为<code>Array</code>类型添加扩展，使其遵循该协议（使用冒泡排序算法）</li>
<li>创建一个函数，接受<code>Sortable</code>类型的参数并调用其<code>sort()</code>方法</li>
</ul>
</li>
</ol>
<h3 id="3-高级应用练习"><a href="#3-高级应用练习" class="headerlink" title="3. 高级应用练习"></a>3. 高级应用练习</h3><ol>
<li><p><strong>实现基于协议的委托模式</strong>：</p>
<ul>
<li>创建一个<code>UserAuthenticationProtocol</code>协议，包含<code>userDidLogin</code>和<code>userDidLogout</code>方法</li>
<li>实现一个<code>AuthenticationManager</code>类，使用委托模式通知登录状态变化</li>
<li>创建一个<code>AppController</code>类作为委托，处理登录状态变化</li>
</ul>
</li>
<li><p><strong>实现泛型协议和条件扩展</strong>：</p>
<ul>
<li>定义一个<code>StorageProtocol</code>泛型协议，包含存储和检索数据的方法</li>
<li>实现一个<code>MemoryStorage</code>结构体，遵循该协议</li>
<li>为协议添加条件扩展，只有当存储的类型是<code>Equatable</code>时，添加<code>contains</code>方法</li>
<li>为协议添加条件扩展，只有当存储的类型是<code>Comparable</code>时，添加<code>sort</code>方法</li>
</ul>
</li>
</ol>
<h2 id="八、总结"><a href="#八、总结" class="headerlink" title="八、总结"></a>八、总结</h2><p>在这篇学习日记中，我们深入探讨了Swift的枚举和协议：</p>
<ol>
<li><p><strong>枚举</strong>：</p>
<ul>
<li>基本枚举定义，使用<code>enum</code>关键字</li>
<li>关联值，为枚举成员添加不同类型的值</li>
<li>原始值，为枚举成员设置相同类型的原始值</li>
<li>递归枚举，枚举成员可以关联包含自身类型的值</li>
<li>枚举方法，枚举可以包含实例方法和类型方法</li>
</ul>
</li>
<li><p><strong>协议</strong>：</p>
<ul>
<li>基本协议定义，使用<code>protocol</code>关键字</li>
<li>协议的属性要求，要求遵循者实现特定的属性</li>
<li>协议的方法要求，要求遵循者实现特定的方法</li>
<li>协议继承，协议可以继承一个或多个其他协议</li>
<li>协议组合，将多个协议组合成一个临时协议</li>
<li>可选协议要求，允许遵循者选择是否实现特定的方法或属性</li>
<li>协议扩展，为协议添加默认实现</li>
</ul>
</li>
<li><p><strong>协议的应用场景</strong>：</p>
<ul>
<li>委托模式，将一个类或结构体的责任委托给另一个类或结构体</li>
<li>多态，允许不同类型的对象以统一的方式处理</li>
</ul>
</li>
</ol>
<p>通过补充的内容机制与知识点总结、遇到的问题及解决方案和高阶用法章节，我们更加全面地理解了Swift枚举和协议的核心概念和高级应用。枚举和协议是Swift面向对象编程的重要组成部分，它们提供了强大的抽象能力和代码复用机制。掌握枚举和协议对于开发高质量的Swift应用程序至关重要。在下一篇学习日记中，我们将继续学习Swift的高级特性，包括扩展和泛型。</p>

  </div>
  <!--文末结束语-->
  
    <div style="text-align:center;color: #ccc;font-size:24px;"> --- 本文结束 <i class="iconfont icon-heartbeat" style="font-size:24px;"></i> The End --- </div>
  
  <!--页脚广告-->
  
  <div class="mdui-divider"></div>
  
  <nav>
    
      <a rel="prev" class="post-nav-item mdui-float-left" href="/ios.github.io/2025/12/10/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E4%B8%83%EF%BC%89/">
        <i class="iconfont icon-angle-left"></i>
        <span>swift学习日记(七)</span>
      </a>
    
    
      <a rel="next" class="post-nav-item mdui-float-right" href="/ios.github.io/2025/12/07/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/">
        <span>swift学习日记(五)</span>
        <i class="iconfont icon-angle-right"></i>
      </a>
    
  </nav>
</article>




  <div class="toc-button"  style="z-index: 100;">
    <button class="mdui-fab mdui-ripple mdui-color-teal" mdui-menu="{target: '#toc'}"><i class="iconfont icon-list"></i></button>
    <ul class="mdui-menu" id="toc">
      <li class="mdui-menu-item">
        <a href="/ios.github.io/2025/12/08/swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/" id="toc-header" class="mdui-ripple">文章目录</a>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Swift%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89%EF%BC%9A%E6%9E%9A%E4%B8%BE%E4%B8%8E%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.</span> <span class="toc-text">Swift学习日记（六）：枚举与协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">一、引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%9E%9A%E4%B8%BE%E7%9A%84%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">二、枚举的定义与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%9E%9A%E4%B8%BE%E5%AE%9A%E4%B9%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 基本枚举定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E8%81%94%E5%80%BC"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 关联值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8E%9F%E5%A7%8B%E5%80%BC"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 原始值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%80%92%E5%BD%92%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.2.4.</span> <span class="toc-text">4. 递归枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%9E%9A%E4%B8%BE%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. 枚举的方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">三、协议的定义与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E5%8D%8F%E8%AE%AE%E5%AE%9A%E4%B9%89"><span class="toc-number">1.3.1.</span> <span class="toc-text">1. 基本协议定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B1%9E%E6%80%A7%E8%A6%81%E6%B1%82"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. 协议的属性要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%96%B9%E6%B3%95%E8%A6%81%E6%B1%82"><span class="toc-number">1.3.3.</span> <span class="toc-text">3. 协议的方法要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%8D%8F%E8%AE%AE%E7%BB%A7%E6%89%BF"><span class="toc-number">1.3.4.</span> <span class="toc-text">4. 协议继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%8D%8F%E8%AE%AE%E7%BB%84%E5%90%88"><span class="toc-number">1.3.5.</span> <span class="toc-text">5. 协议组合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%8F%AF%E9%80%89%E5%8D%8F%E8%AE%AE%E8%A6%81%E6%B1%82"><span class="toc-number">1.3.6.</span> <span class="toc-text">6. 可选协议要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95"><span class="toc-number">1.3.7.</span> <span class="toc-text">7. 协议扩展</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.4.</span> <span class="toc-text">四、协议的应用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A7%94%E6%89%98%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.4.1.</span> <span class="toc-text">1. 委托模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%9A%E6%80%81"><span class="toc-number">1.4.2.</span> <span class="toc-text">2. 多态</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%86%85%E5%AE%B9%E6%9C%BA%E5%88%B6%E4%B8%8E%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">五、内容机制与知识点总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Swift%E6%9E%9A%E4%B8%BE%E4%B8%8E%E5%8D%8F%E8%AE%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="toc-number">1.5.1.</span> <span class="toc-text">1. Swift枚举与协议的设计原则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.2.</span> <span class="toc-text">2. 核心知识点总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.6.</span> <span class="toc-text">六、遇到的问题及解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9E%9A%E4%B8%BE%E6%88%90%E5%91%98%E5%90%8D%E7%A7%B0%E4%B8%8E%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B%E5%86%B2%E7%AA%81"><span class="toc-number">1.6.1.</span> <span class="toc-text">1. 枚举成员名称与系统类型冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%8F%E8%AE%AE%E6%96%B9%E6%B3%95%E6%9C%AA%E5%AE%9E%E7%8E%B0%E5%AF%BC%E8%87%B4%E7%BC%96%E8%AF%91%E9%94%99%E8%AF%AF"><span class="toc-number">1.6.2.</span> <span class="toc-text">2. 协议方法未实现导致编译错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95%E4%B8%AD%E7%9A%84%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0%E6%9C%AA%E8%A2%AB%E8%B0%83%E7%94%A8"><span class="toc-number">1.6.3.</span> <span class="toc-text">3. 协议扩展中的默认实现未被调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%80%92%E5%BD%92%E6%9E%9A%E4%B8%BE%E5%AF%BC%E8%87%B4%E6%A0%88%E6%BA%A2%E5%87%BA"><span class="toc-number">1.6.4.</span> <span class="toc-text">4. 递归枚举导致栈溢出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%A7%94%E6%89%98%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8"><span class="toc-number">1.6.5.</span> <span class="toc-text">5. 委托循环引用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E9%AB%98%E9%98%B6%E7%94%A8%E6%B3%95"><span class="toc-number">1.7.</span> <span class="toc-text">七、高阶用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%AB%98%E7%BA%A7%E6%9E%9A%E4%B8%BE%E6%8A%80%E5%B7%A7"><span class="toc-number">1.7.1.</span> <span class="toc-text">1. 高级枚举技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E6%9E%9A%E4%B8%BE%E4%B8%8E%E6%B3%9B%E5%9E%8B%E7%BB%93%E5%90%88"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">1.1 枚举与泛型结合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E6%9E%9A%E4%B8%BE%E4%B8%8E%E5%8D%8F%E8%AE%AE%E7%BB%93%E5%90%88"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">1.2 枚举与协议结合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E6%9E%9A%E4%B8%BE%E4%B8%8E%E6%89%A9%E5%B1%95%E7%BB%93%E5%90%88"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">1.3 枚举与扩展结合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%AB%98%E7%BA%A7%E5%8D%8F%E8%AE%AE%E6%8A%80%E5%B7%A7"><span class="toc-number">1.7.2.</span> <span class="toc-text">2. 高级协议技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E6%B3%9B%E5%9E%8B%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">2.1 泛型协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%89%A9%E5%B1%95"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">2.2 协议的条件扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%85%B3%E8%81%94%E7%B1%BB%E5%9E%8B%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">2.3 协议的关联类型约束</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%AB%98%E7%BA%A7%E5%A7%94%E6%89%98%E4%B8%8E%E5%A4%9A%E6%80%81%E6%8A%80%E5%B7%A7"><span class="toc-number">1.7.3.</span> <span class="toc-text">3. 高级委托与多态技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%8D%8F%E8%AE%AE%E7%BB%84%E5%90%88%E4%B8%8E%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">3.1 协议组合与类型擦除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E5%9F%BA%E4%BA%8E%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"><span class="toc-number">1.7.3.2.</span> <span class="toc-text">3.2 基于协议的依赖注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">1.7.4.</span> <span class="toc-text">4. 性能优化策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E6%9E%9A%E4%B8%BE%E7%9A%84%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96"><span class="toc-number">1.7.4.1.</span> <span class="toc-text">4.1 枚举的内存优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95%E7%9A%84%E6%80%A7%E8%83%BD%E8%80%83%E9%87%8F"><span class="toc-number">1.7.4.2.</span> <span class="toc-text">4.2 协议扩展的性能考量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E9%81%BF%E5%85%8D%E8%BF%87%E5%BA%A6%E4%BD%BF%E7%94%A8%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.7.4.3.</span> <span class="toc-text">4.3 避免过度使用协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%8C%87%E5%8D%97"><span class="toc-number">1.7.5.</span> <span class="toc-text">5. 最佳实践指南</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%AE%9E%E8%B7%B5%E7%BB%83%E4%B9%A0"><span class="toc-number">1.8.</span> <span class="toc-text">七、实践练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9E%9A%E4%B8%BE%E5%9F%BA%E7%A1%80%E7%BB%83%E4%B9%A0"><span class="toc-number">1.8.1.</span> <span class="toc-text">1. 枚举基础练习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%BB%83%E4%B9%A0"><span class="toc-number">1.8.2.</span> <span class="toc-text">2. 协议基础练习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8%E7%BB%83%E4%B9%A0"><span class="toc-number">1.8.3.</span> <span class="toc-text">3. 高级应用练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">1.9.</span> <span class="toc-text">八、总结</span></a></li></ol></li></ol>
      </li>
    </ul>
  </div>



    <div id="comment" class="mdui-card mdui-p-a-2 mdui-m-b-5">
      <div class="mdui-tab" mdui-tab>
        
          <a href="#comment-tab0" class="mdui-ripple">gitalk</a>
        
          <a href="#comment-tab1" class="mdui-ripple">livere</a>
        
      </div>
      
        <div id="comment-tab0" class="mdui-p-a-2">
          <div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: '',
    admin: [''],
    id:  md5(location.pathname) ,
    distractionFreeMode: 'true',
  });
  gitalk.render('gitalk-container');
</script>
        </div>
      
        <div id="comment-tab1" class="mdui-p-a-2">
          <div id="lv-container" data-id="city" data-uid="">
  <script type="text/javascript">
    (function (d, s) {
      var j, e = d.getElementsByTagName(s)[0];
      if (typeof LivereTower === 'function') { return; }
      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;
      e.parentNode.insertBefore(j, e);
    })(document, 'script');
  </script>
  <noscript>Please enable JavaScript to view the comments powered by LiveRe.</noscript>
</div>
        </div>
      
    </div>

  </main>
  <footer id="footer" class="mdui-text-center mdui-m-t-5 mdui-p-b-2 mdui-p-t-4 mdui-color-theme">
  <div class="mdui-container">
    <div class="mdui-row">
      
      <span>
        &copy; 2025 - 2025 
        
        猪会飞
      </span>
    </div>
    <div class="mdui-row">
      
        <span>Theme: <a href="https://github.com/kb1000fx/hexo-theme-meadow" rel="noopener" target="_blank">Meadow</a></span>
      
    </div>
    <div class="mdui-row">
      
    </div>
 </div>
</footer>
  
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-teal" style="z-index:100;"><i class="iconfont icon-arrowup"></i></button>
  
  




    <script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({
        startOnLoad: true,
        theme: "default"
    });</script>




    
<script src="/ios.github.io/js/mdui.min.v1.0.0.js"></script>




<script src="/ios.github.io/js/meadow.js"></script>

</body>
</html >